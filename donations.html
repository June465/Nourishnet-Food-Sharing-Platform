<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Donations - NourishNet</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css" />
    <!-- Using practice.css for donations -->
    <link rel="stylesheet" href="css/practice.css" />
    <link rel="icon" type="image/png" sizes="32x32" href="images/logo.jpg" />
  </head>
  <body>
    <!-- Navigation Bar -->
    <section class="header">
      <a href="index.html" class="logo">NOURISH<span class="highlight">NET</span></a>
      <nav class="navbar">
        <a href="index.html">Home</a>
        <a href="about.html">About</a>
        <a href="donations.html">Donations</a>
        <a href="register.html">Register</a>
        <a href="login.html">Login</a>
      </nav>
      <div id="menu-btn" class="fas fa-bars"></div>
    </section>

    <div class="heading">Donations</div>

    <section class="donations">
      <h1 class="heading-title">Available Donations</h1>
      <div class="box-container" id="donations-container">
        <!-- Donation boxes will be loaded dynamically -->
      </div>
      <!-- Past Feedback Section -->
      <section class="past-feedback">
        <h2>Past Donation Feedback</h2>
        <div id="feedback-list">
          <!-- Feedback items loaded dynamically via feedback.js -->
        </div>
      </section>
    </section>
    
    <!-- Footer Section -->
    <footer class="footer">
      <div class="footer-container">
        <div class="footer-left">
          <h2 class="brand">NOURISH<span class="highlight">NET</span></h2>
          <p>Connecting surplus food to those in need.</p>
        </div>
        <div class="footer-links">
          <h3>Quick Links</h3>
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="about.html">About Us</a></li>
            <li><a href="#">Initiatives</a></li>
            <li><a href="#">Partners</a></li>
            <li><a href="#">Contact</a></li>
          </ul>
        </div>
        <div class="footer-links">
          <h3>Legal</h3>
          <ul>
            <li><a href="#">Privacy Policy</a></li>
            <li><a href="#">Terms of Use</a></li>
            <li><a href="#">Refund & Cancellation Policy</a></li>
          </ul>
        </div>
        <div class="footer-contact">
          <h3>GET IN TOUCH</h3>
          <p>ðŸ“§ <a href="mailto:support@nourishnet.org">Support@NourishNet.org</a></p>
        </div>
      </div>
      <div class="footer-bottom">
        <p>Copyright Â© 2025 NourishNet. All Rights Reserved.</p>
      </div>
    </footer>

    <!-- Order Overlay (hidden by default) -->
    <div id="order-overlay" class="overlay"></div>

    <!-- FontAwesome CDN for Icons -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" crossorigin="anonymous"></script>
    <!-- Custom JS Files -->
    <script src="js/script.js"></script>
    <script src="js/order.js"></script>
    <script src="js/feedback.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/overlay.js"></script>
    <script>
      // Load active donations on page load
      document.addEventListener('DOMContentLoaded', () => {
        loadActiveDonations();
      });

      async function loadActiveDonations() {
        try {
          const res = await fetch('/api/donations/active');
          const data = await res.json();
          if (!data.donations) return;
          const container = document.getElementById('donations-container');
          container.innerHTML = '';

          data.donations.forEach((donation) => {
            const box = document.createElement('div');
            box.classList.add('box');
            // Give each card a unique ID and a span for donation quantity
            box.id = `donation-card-${donation._id}`;
            box.innerHTML = `
              <div class="image">
                <img src="${donation.foodImage || 'images/donation-1.png'}" alt="Donation Image" />
              </div>
              <h3>${donation.foodType} Donation</h3>
              <p>
                <span class="donation-quantity">${donation.quantity}</span> servings | ${donation.location}
              </p>
              <button class="btn" onclick="openOrderOverlay('${donation._id}')">Request Donation</button>
            `;
            container.appendChild(box);
          });
        } catch (err) {
          console.error(err);
        }
      }
    </script>
  </body>
</html>
